!function(a){function c(c){c=c||{},b=navigator.userAgent.match(/OS [1-4](?:_\d+)+ like Mac/)?"page":"client";var g=a.createElement("div"),h="draggable"in g,i="ondragstart"in g&&"ondrop"in g,j=!(h||i)||/iPad|iPhone|iPod|Android/.test(navigator.userAgent);l((j?"":"not ")+"patching html5 drag drop"),j&&(c.enableEnterLeave||(d.prototype.synthesizeEnterLeave=n),c.holdToDrag?a.addEventListener("touchstart",e(c.holdToDrag)):a.addEventListener("touchstart",f))}function d(a,b){this.dragData={},this.dragDataTypes=[],this.dragImage=null,this.dragImageTransform=null,this.dragImageWebKitTransform=null,this.customDragImage=null,this.customDragImageX=null,this.customDragImageY=null,this.el=b||a.target,l("dragstart"),this.dispatchDragStart()&&(this.createDragImage(),this.listen())}function e(a){return function(b){var c=b.target;if(c.draggable===!0)var d=function(){h.off(),j.off(),k.off(),f(b)},e=function(){h.off(),j.off(),k.off(),clearTimeout(g)},g=setTimeout(d,a),h=i(c,"touchend",e,this),j=i(c,"touchcancel",e,this),k=i(window,"scroll",e,this)}}function f(b){var c=b.target;do if(c.draggable===!0){if(!c.hasAttribute("draggable")&&"a"==c.tagName.toLowerCase()){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,c.ownerDocument.defaultView,1,b.screenX,b.screenY,b.clientX,b.clientY,b.ctrlKey,b.altKey,b.shiftKey,b.metaKey,0,null),c.dispatchEvent(e),l("Simulating click to anchor")}b.preventDefault(),new d(b,c);break}while((c=c.parentNode)&&c!==a.body)}function g(c,d){var e=d.changedTouches[0],f=a.elementFromPoint(e[b+"X"],e[b+"Y"]);return f}function h(a){var b=a.getBoundingClientRect();return{x:b.left,y:b.top}}function i(a,b,c,d){return d&&(c=c.bind(d)),a.addEventListener(b,c),{off:function(){return a.removeEventListener(b,c)}}}function j(a,b,c,d){function e(d){return c(d),a.removeEventListener(b,e)}return d&&(c=c.bind(d)),a.addEventListener(b,e)}function k(a,b){if(1==a.nodeType){b.removeAttribute("id"),b.removeAttribute("class"),b.removeAttribute("style"),b.removeAttribute("draggable");for(var c=window.getComputedStyle(a),d=0;d<c.length;d++){var e=c[d];b.style.setProperty(e,c.getPropertyValue(e),c.getPropertyPriority(e))}b.style.pointerEvents="none"}if(a.hasChildNodes())for(var f=0;f<a.childNodes.length;f++)k(a.childNodes[f],b.childNodes[f])}function l(a){console.log(a)}function m(a){return 0===a.length?0:a.reduce(function(a,b){return b+a},0)/a.length}function n(){}l=n;var b;d.prototype={listen:function(){function e(a){this.dragend(a,a.target),f.call(this)}function f(){return l("cleanup"),this.dragDataTypes=[],null!==this.dragImage&&(this.dragImage.parentNode.removeChild(this.dragImage),this.dragImage=null,this.dragImageTransform=null,this.dragImageWebKitTransform=null),this.customDragImage=null,this.customDragImageX=null,this.customDragImageY=null,this.el=this.dragData=null,[b,c,d].forEach(function(a){return a.off()})}var b=i(a,"touchmove",this.move,this),c=i(a,"touchend",e,this),d=i(a,"touchcancel",f,this)},move:function(a){a.preventDefault();var b=[],c=[];[].forEach.call(a.changedTouches,function(a){b.push(a.pageX),c.push(a.pageY)});var d=m(b)-(this.customDragImageX||parseInt(this.dragImage.offsetWidth,10)/2),e=m(c)-(this.customDragImageY||parseInt(this.dragImage.offsetHeight,10)/2);this.translateDragImage(d,e),this.synthesizeEnterLeave(a)},translateDragImage:function(a,b){var c="translate("+a+"px,"+b+"px) ";null!==this.dragImageWebKitTransform&&(this.dragImage.style["-webkit-transform"]=c+this.dragImageWebKitTransform),null!==this.dragImageTransform&&(this.dragImage.style.transform=c+this.dragImageTransform)},synthesizeEnterLeave:function(a){var b=g(this.el,a);b!=this.lastEnter&&(this.lastEnter&&this.dispatchLeave(a),this.lastEnter=b,this.lastEnter&&this.dispatchEnter(a)),this.lastEnter&&this.dispatchOver(a)},dragend:function(b){l("dragend"),this.lastEnter&&this.dispatchLeave(b);var c=g(this.el,b);c?(l("found drop target "+c.tagName),this.dispatchDrop(c,b)):l("no drop target");var d=a.createEvent("Event");d.initEvent("dragend",!0,!0),this.el.dispatchEvent(d)},dispatchDrop:function(c,d){var e=a.createEvent("Event");e.initEvent("drop",!0,!0);var f=d.changedTouches[0],g=f[b+"X"],i=f[b+"Y"],k=h(c);e.offsetX=g-k.x,e.offsetY=i-k.y,e.dataTransfer={types:this.dragDataTypes,getData:function(a){return this.dragData[a]}.bind(this),dropEffect:"move"},e.preventDefault=function(){}.bind(this),j(a,"drop",function(){l("drop event not canceled")},this),c.dispatchEvent(e)},dispatchEnter:function(b){var c=a.createEvent("Event");c.initEvent("dragenter",!0,!0),c.dataTransfer={types:this.dragDataTypes,getData:function(a){return this.dragData[a]}.bind(this)};var d=b.changedTouches[0];c.pageX=d.pageX,c.pageY=d.pageY,c.clientX=d.clientX,c.clientY=d.clientY,this.lastEnter.dispatchEvent(c)},dispatchOver:function(b){var c=a.createEvent("Event");c.initEvent("dragover",!0,!0),c.dataTransfer={types:this.dragDataTypes,getData:function(a){return this.dragData[a]}.bind(this)};var d=b.changedTouches[0];c.pageX=d.pageX,c.pageY=d.pageY,c.clientX=d.clientX,c.clientY=d.clientY,this.lastEnter.dispatchEvent(c)},dispatchLeave:function(b){var c=a.createEvent("Event");c.initEvent("dragleave",!0,!0),c.dataTransfer={types:this.dragDataTypes,getData:function(a){return this.dragData[a]}.bind(this)};var d=b.changedTouches[0];c.pageX=d.pageX,c.pageY=d.pageY,c.clientX=d.clientX,c.clientY=d.clientY,this.lastEnter.dispatchEvent(c),this.lastEnter=null},dispatchDragStart:function(){var b=a.createEvent("Event");return b.initEvent("dragstart",!0,!0),b.dataTransfer={setData:function(a,b){return this.dragData[a]=b,this.dragDataTypes.indexOf(a)==-1&&(this.dragDataTypes[this.dragDataTypes.length]=a),b}.bind(this),setDragImage:function(a,b,c){this.customDragImage=a,this.customDragImageX=b,this.customDragImageY=c}.bind(this),dropEffect:"move"},this.el.dispatchEvent(b)},createDragImage:function(){this.customDragImage?(this.dragImage=this.customDragImage.cloneNode(!0),k(this.customDragImage,this.dragImage)):(this.dragImage=this.el.cloneNode(!0),k(this.el,this.dragImage)),this.dragImage.style.opacity="0.5",this.dragImage.style.position="absolute",this.dragImage.style.left="0px",this.dragImage.style.top="0px",this.dragImage.style.zIndex="999999";var b=this.dragImage.style.transform;"undefined"!=typeof b&&(this.dragImageTransform="","none"!=b&&(this.dragImageTransform=b.replace(/translate\(\D*\d+[^,]*,\D*\d+[^,]*\)\s*/g,"")));var c=this.dragImage.style["-webkit-transform"];"undefined"!=typeof c&&(this.dragImageWebKitTransform="","none"!=c&&(this.dragImageWebKitTransform=c.replace(/translate\(\D*\d+[^,]*,\D*\d+[^,]*\)\s*/g,""))),this.translateDragImage(-9999,-9999),a.body.appendChild(this.dragImage)}},c(window.iosDragDropShim)}(document);