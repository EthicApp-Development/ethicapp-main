var tableSortModule=angular.module("tableSort",[]);tableSortModule.provider("tableSortConfig",function(){this.filterTemplate="",this.filterFunction=void 0,this.paginationTemplate="",this.perPageOptions=[10,25,50,100],this.perPageDefault=this.perPageOptions[0],this.itemNameSingular="item",this.itemNamePlural=this.itemNameSingular+"s",this.noDataText="No "+this.itemNamePlural,this.wrappingElementClass="",isNaN(this.perPageDefault)||-1!==this.perPageOptions.indexOf(this.perPageDefault)||this.perPageOptions.push(this.perPageDefault),this.perPageOptions.sort(function(t,e){return t-e}),this.$get=function(){return this}}),tableSortModule.directive("tsWrapper",["$parse","$compile",function(t,e){"use strict";function r(t,e){return e.replace(/FILTER_STRING/g,"filtering.filterString").replace(/CURRENT_PAGE_RANGE/g,"pagination.getPageRangeString(TOTAL_COUNT)").replace(/TOTAL_COUNT/g,t.itemsArrayExpression+".length").replace(/PER_PAGE_OPTIONS/g,"pagination.perPageOptions").replace(/ITEMS_PER_PAGE/g,"pagination.perPage").replace(/ITEM_NAME_SINGULAR/g,"itemNameSingular").replace(/ITEM_NAME_PLURAL/g,"itemNamePlural").replace(/FILTERED_COUNT/g,"filtering.filteredCount").replace(/CURRENT_PAGE_NUMBER/g,"pagination.currentPage")}var i=function(){function t(t,e){return t>e?1:t<e?-1:0}var e=t,r=t;return"object"==typeof Intl&&"function"==typeof Intl.Collator?e=new Intl.Collator(void 0,{sensitivity:"case"}).compare:"function"==typeof String.prototype.localeCompare&&(e=function(t,e){return(t+"").localeCompare(e,void 0,{sensitivity:"case"})}),function(t,i){return"number"==typeof t&&"number"==typeof i?r(t,i):t instanceof Date&&i instanceof Date?r(t.getTime(),i.getTime()):e(t,i)}}();return{scope:!0,controller:["$scope","tableSortConfig",function(e,r){e.pagination={template:r.paginationTemplate,perPageOptions:r.perPageOptions.concat(),perPage:r.perPageDefault,currentPage:1,getPageRangeString:function(t){var r=t!==e.filtering.filteredCount?e.filtering.filteredCount:t,i=Math.max((e.pagination.currentPage-1)*e.pagination.perPage+1,1),n=Math.min(e.pagination.currentPage*e.pagination.perPage,r);return 0===e.filtering.filteredCount?"":(n===r&&1===i?"":i+"-")+n}},e.filtering={template:r.filterTemplate,filterString:"",filterFunction:r.filterFunction,filteredCount:0,filterFields:[]},e.itemsArrayExpression="",e.itemNameSingular=r.itemNameSingular,e.itemNamePlural=r.itemNamePlural,e.noDataText=r.noDataText,e.wrappingElementClass=r.wrappingElementClass,e.sortExpression=[],e.headings=[];var i=function(e,r){return[t(e),null,!1,r||e]};this.setSortField=function(t,r,n,a){var s,l=i(t,n);if(l.push(a),1===e.sortExpression.length&&e.sortExpression[0][0]===l[0])e.sortExpression[0][2]?(r.removeClass("tablesort-desc"),r.addClass("tablesort-asc"),e.sortExpression[0][2]=!1):(r.removeClass("tablesort-asc"),r.addClass("tablesort-desc"),e.sortExpression[0][2]=!0),e.$emit("tablesort:sortOrder",[{name:e.sortExpression[0][3],order:e.sortExpression[0][2]}]);else{for(s=0;s<e.headings.length;s+=1)e.headings[s].removeClass("tablesort-desc").removeClass("tablesort-asc");r.addClass("tablesort-asc"),e.sortExpression=[l],e.$emit("tablesort:sortOrder",[{name:l[3],order:l[2]}])}},this.addSortField=function(t,r,n,a){var s,l=!1,o=i(t,n);for(o.push(a),s=0;s<e.sortExpression.length;s+=1)e.sortExpression[s][0]===o[0]&&(e.sortExpression[s][2]?(r.removeClass("tablesort-desc"),r.addClass("tablesort-asc"),e.sortExpression[s][2]=!1):(r.removeClass("tablesort-asc"),r.addClass("tablesort-desc"),e.sortExpression[s][2]=!0),l=!0);l||(r.addClass("tablesort-asc"),e.sortExpression.push(o)),e.$emit("tablesort:sortOrder",e.sortExpression.map(function(t){return{name:t[3],order:t[2]}}))},this.setTrackBy=function(t){e.trackBy=t},this.registerHeading=function(t){e.headings.push(t)},this.addFilterField=function(t,r){var n=i(t);e.filtering.filterFields.push(n)},this.setArrayExpr=function(t){e.itemsArrayExpression=t}}],link:function(n,a,s,l){function o(t){try{var e=n.$eval(t);return e||t}catch(e){return t}}if(s.tsItemName){var p="No "+n.itemNamePlural;n.itemNameSingular=o(s.tsItemName),s.tsItemNamePlural?n.itemNamePlural=o(s.tsItemNamePlural):n.itemNamePlural=o(s.tsItemName)+"s",s.tsNoDataText||n.noDataText!==p||(n.noDataText="No "+n.itemNamePlural)}if(s.tsNoDataText&&(n.noDataText=o(s.tsNoDataText)),s.tsWrappingElementClass&&(n.wrappingElementClass=s.tsWrappingElementClass),s.tsPerPageOptions&&(n.pagination.perPageOptions=n.$eval(s.tsPerPageOptions)),s.tsPerPageDefault){var u=n.$eval(s.tsPerPageDefault);isNaN(u)||(n.pagination.perPage=u,-1===n.pagination.perPageOptions.indexOf(n.pagination.perPage)&&(n.pagination.perPageOptions.push(n.pagination.perPage),n.pagination.perPageOptions.sort(function(t,e){return t-e})))}if(s.tsFilterFields)for(var f=s.tsFilterFields.split(",").filter(function(t){return t&&""!==t.trim()}),g=0;g<f.length;g+=1)l.addFilterField(f[g]);var c,d,m;if("false"!==s.tsDisplayFiltering&&""!==n.filtering.template&&n.filtering.filterFields.length>0){var h=r(n,n.filtering.template);c=e(h)(n),a.parent()[0].insertBefore(c[0],a[0])}if(s.tsFilterFunction&&(n.filtering.filterFunction=n.$eval(s.tsFilterFunction)),angular.isFunction(n.filtering.filterFunction)||(0===n.filtering.filterFields.length?n.filtering.filterFunction=function(t){return!0}:n.filtering.filterFunction=function(t){for(var e=!1,r=0;r<n.filtering.filterFields.length;r+=1){if(!e)e=(n.filtering.filterFields[r][0](t)||"").toString().toLowerCase().indexOf(n.filtering.filterString.toLowerCase())>-1}return e}),n.filterLimitFun=function(t){if(!s.tsFilterFunction&&""===n.filtering.filterString)return n.filtering.filteredCount=t.length,t;var e=t.filter(n.filtering.filterFunction);return n.filtering.filteredCount=e.length,e},n.sortFun=function(e,r){var a,s,l,o,p,u;for(a=0;a<n.sortExpression.length;a+=1){if(s=n.sortExpression[a][0](e),l=n.sortExpression[a][0](r),(p=r[n.sortExpression[a][1]])&&(s=p(s),l=p(l)),null==s&&(s=""),null==l&&(l=""),o=n.sortExpression[a][2],(u=(n.sortExpression[a][4]||i)(s,l))>0)return o?-1:1;if(u<0)return o?1:-1}if(n.trackBy){if("$index"===n.trackBy){var f=t(n.itemsArrayExpression)(n);s=f.indexOf(e),l=f.indexOf(r)}else s=e[n.trackBy],l=r[n.trackBy];if(null==s&&(s=""),null==l&&(l=""),(u=i(s,l))>0)return o?-1:1;if(u<0)return o?1:-1}return 0},n.pageLimitFun=function(t){if("false"===s.tsDisplayPagination||""===n.pagination.template)return t;for(var e=(n.pagination.currentPage-1)*n.pagination.perPage,r=n.pagination.currentPage*n.pagination.perPage,i=[],a=0;a<t.length;a++)a>=e&&a<r&&i.push(t[a]);return i},"false"!==s.tsDisplayPagination&&""!==n.pagination.template){var P=r(n,n.pagination.template);d=e(P)(n),a.after(d)}if(n.wrappingElementClass&&""!==n.wrappingElementClass&&(m=a.wrap("<div class='"+n.wrappingElementClass+"' />")),s.tsGetTableDataFunction){(0,t(s.tsGetTableDataFunction).assign)(n.$parent,function(e,r,i){var a=t(n.itemsArrayExpression)(n);return e&&(a=a.sort(n.sortFun)),r&&(a=n.filterLimitFun(a)),i&&(a=n.pageLimitFun(a)),a})}n.$on("$destroy",function(){c&&c.remove(),d&&d.remove(),m&&m.replaceWith(a)})}}}]),tableSortModule.directive("tsCriteria",function(){return{require:"^tsWrapper",scope:{tsOrderBy:"="},link:function(t,e,r,i){e[e.on?"on":"bind"]("click",function(n){t.$apply(function(){n.shiftKey?i.addSortField(r.tsCriteria,e,r.tsName,t.tsOrderBy):i.setSortField(r.tsCriteria,e,r.tsName,t.tsOrderBy)})}),e[e.on?"on":"bind"]("keypress",function(n){t.$apply(function(){13!==n.which&&32!==n.which||i.setSortField(r.tsCriteria,e,r.tsName,t.tsOrderBy)})}),e.addClass("tablesort-sortable"),"tsDefault"in r&&"0"!==r.tsDefault&&void 0!==r.tsDefault&&(i.addSortField(r.tsCriteria,e,r.tsName,t.tsOrderBy),"descending"===r.tsDefault&&i.addSortField(r.tsCriteria,e,r.tsName,t.tsOrderBy)),"tsFilter"in r&&i.addFilterField(r.tsFilter||r.tsCriteria,e),i.registerHeading(e)}}}),tableSortModule.directive("tsRepeat",["$compile","$interpolate",function(t,e){return{terminal:!0,multiElement:!0,require:"^tsWrapper",priority:1e6,link:function(r,i,n,a){for(var s=["ng-repeat","data-ng-repeat","ng-repeat-start","data-ng-repeat-start"],l=s[0],o="ts-repeat",p=0;p<s.length;p++)if(angular.isDefined(i.attr(s[p]))){o=(l=s[p]).replace(/^(data-)?ng/,"$1ts");break}var u="tablesortOrderBy:sortFun | tablesortLimit:filterLimitFun | tablesortLimit:pageLimitFun",f=i.attr(l),g=/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(\s+track\s+by\s+[\s\S]+?)?\s*$/,c=f.match(/\s+track\s+by\s+(\$index|\S+?\.(\S+))/),d=f.match(g);if(c&&a.setTrackBy(c[2]||c[1]),-1!==f.search(/tablesort/)?(f=f.replace(/tablesort/,u),c&&(f=f.replace(c[0],"")+c[0])):f=f.replace(g,"$1 in $2 | "+u+"$3"),angular.isUndefined(n.tsHideNoData)){var m=e.startSymbol(),h=e.endSymbol(),P=angular.element(i[0]).clone();P.removeAttr(l),P.removeAttr(o),P.addClass("showIfLast"),P.children().remove(),P.append('<td colspan="'+i[0].childElementCount+'">'+m+"noDataText"+h+"</td>"),P=t(P)(r),i.parent().prepend(P)}a.setArrayExpr(d[2]),angular.element(i[0]).attr(l,f),t(i,null,1e6)(r)}}}]),tableSortModule.filter("tablesortLimit",function(){return function(t,e){if(t)return e(t)}}),tableSortModule.filter("tablesortOrderBy",function(){return function(t,e){if(t)return t.concat().sort(e)}}),tableSortModule.filter("parseInt",function(){return function(t){var e=parseInt(t);return isNaN(e)?null:e}}),tableSortModule.filter("parseFloat",function(){return function(t){var e=parseFloat(t);return isNaN(e)?null:e}}),tableSortModule.filter("parseDate",function(){return function(t){var e=Date.parse(t);return isNaN(e)?null:e}});
